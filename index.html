<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Enactus Alumni Reunion | Exclusive RSVP</title>
    
    <!-- Premium Typography -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&family=Sora:wght@400;600;700&family=Manrope:wght@400;600;700&display=swap" rel="stylesheet">
    
    <style>
        :root {
            /* Sophisticated Color Palette */
            --color-deep-space: #0F1020;           /* Deep midnight navy */
            --color-electric-blue: #2E5BE6;        /* Vibrant professional blue */
            --color-glacier-cyan: #00B4D8;         /* Modern accent cyan */
            --color-titanium-gray: #353C52;        /* Sophisticated gray */
            --color-frost-white: #F5F7FA;          /* Soft background white */
            --color-emerald-accent: #10B981;       /* Elegant success green */
            
            /* Refined Gradients */
            --gradient-primary: linear-gradient(135deg, var(--color-electric-blue) 0%, var(--color-glacier-cyan) 100%);
            --gradient-secondary: linear-gradient(145deg, var(--color-deep-space) 0%, var(--color-titanium-gray) 100%);
            
            /* Typography Scale */
            --font-primary: 'Inter', sans-serif;
            --font-secondary: 'Sora', sans-serif;
            --font-accent: 'Manrope', sans-serif;
            
            /* Advanced Shadow System */
            --shadow-subtle: 0 4px 12px rgba(46,91,230,0.1);
            --shadow-medium: 0 10px 30px rgba(46,91,230,0.15);
            --shadow-intense: 0 15px 45px rgba(46,91,230,0.2);
        }

        /* Comprehensive Reset */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            transition: all 0.3s ease;
        }

        body {
            font-family: var(--font-primary);
            background: linear-gradient(135deg, var(--color-frost-white) 0%, #E9ECF3 100%);
            color: var(--color-deep-space);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            line-height: 1.6;
            overflow-x: hidden;
            padding: 40px 20px;
        }

        .reunion-container {
            width: 100%;
            max-width: 1200px;
            background: white;
            border-radius: 32px;
            box-shadow: 
                0 50px 100px rgba(46,91,230,0.08), 
                0 15px 35px rgba(46,91,230,0.05);
            display: grid;
            grid-template-columns: 1.3fr 1.7fr;
            min-height: 850px;
            overflow: hidden;
        }

        /* Branding Panel */
        .branding-panel {
            background: var(--gradient-primary);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 60px 40px;
            color: white;
            text-align: center;
            position: relative;
        }

        .branding-panel::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: rgba(255,255,255,0.05);
            transform: rotate(-45deg);
        }

        .enactus-logo {
            width: 280px;
            margin-bottom: 40px;
            filter: drop-shadow(0 15px 25px rgba(0,0,0,0.2));
            z-index: 2;
            position: relative;
        }

        .branding-title {
            font-family: var(--font-secondary);
            font-size: 3.2rem;
            font-weight: 700;
            margin-bottom: 25px;
            letter-spacing: 1.5px;
            text-transform: uppercase;
        }

        .branding-subtitle {
            max-width: 420px;
            line-height: 2;
            font-size: 1.1rem;
            opacity: 0.9;
        }

        /* RSVP Form Section */
        .rsvp-form-section {
            background: var(--color-frost-white);
            padding: 70px;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .welcome-section {
            margin-bottom: 50px;
            text-align: center;
        }

        .alumni-name {
            font-family: var(--font-secondary);
            font-size: 3rem;
            color: var(--color-electric-blue);
            margin-bottom: 15px;
        }

        .graduation-badge {
            display: inline-block;
            background: var(--gradient-secondary);
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.9rem;
            margin-top: 15px;
        }

        .form-header {
            text-align: center;
            margin-bottom: 50px;
        }

        .form-title {
            font-family: var(--font-secondary);
            font-size: 2.8rem;
            color: var(--color-electric-blue);
            margin-bottom: 20px;
            font-weight: 700;
        }

        .form-description {
            color: var(--color-titanium-gray);
            max-width: 500px;
            margin: 0 auto;
            line-height: 1.8;
        }

        .form-group {
            margin-bottom: 35px;
            position: relative;
        }

        .form-label {
            display: block;
            margin-bottom: 15px;
            font-weight: 600;
            color: var(--color-electric-blue);
            font-family: var(--font-secondary);
        }

        .form-input {
            width: 100%;
            padding: 20px 25px;
            border: 2px solid rgba(46,91,230,0.15);
            border-radius: 16px;
            font-size: 16px;
            background: white;
            font-family: var(--font-primary);
        }

        .form-input:focus {
            outline: none;
            border-color: var(--color-electric-blue);
            box-shadow: 0 0 0 4px rgba(46,91,230,0.1);
        }

        .submit-button {
            width: 100%;
            padding: 22px;
            background: var(--gradient-secondary);
            color: white;
            border: none;
            border-radius: 20px;
            font-size: 18px;
            font-weight: 700;
            cursor: pointer;
            text-transform: uppercase;
            letter-spacing: 2px;
            box-shadow: var(--shadow-medium);
        }

        .submit-button:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-intense);
        }

        /* Responsive Adjustments */
        @media (max-width: 1024px) {
            .reunion-container {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="reunion-container">
        <div class="branding-panel">
            <img src="/api/placeholder/280/180" alt="Enactus Logo" class="enactus-logo">
            <h2 class="branding-title">Enactus Menoufia Opening</h2>
            <p class="branding-subtitle">
                Reconnect with purpose. Amplify your entrepreneurial journey with a community that transforms ideas into impactful solutions.
            </p>
        </div>

        <div class="rsvp-form-section">
            <div class="welcome-section">
                <h1 class="alumni-name" id="alumniName">Loading...</h1>
                <p id="welcomMessage">Preparing your personalized invitation...</p>
                <span class="graduation-badge" id="graduationYear">Enactus Class</span>
            </div>


            <form id="rsvpForm">
                <div class="form-group">
                    <label for="name" class="form-label">Full Name</label>
                    <input type="text" id="name" class="form-input" placeholder="Enter your full name" required>
                </div>
                
                <div class="form-group">
                    <label for="mealPreference" class="form-label">Culinary Selection</label>
                    <select id="mealPreference" class="form-input" required>
                        <option value="">Select Your Dining Experience</option>
                        <option value="Mini Burger + Kofta">Mini Burger + Kofta</option>
                        <option value="Mini Burger + Sheesh">Mini Burger + Sheesh</option>
                        <option value="Mini Burger + Pane">Mini Burger + Pane</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="notes" class="form-label">Additional Considerations</label>
                    <textarea id="notes" class="form-input" rows="3" placeholder="Any specific requirements or notes?"></textarea>
                </div>
                
                <button type="submit" class="submit-button">Confirm Attendance</button>
            </form>
        </div>
    </div>

    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
    <script>
        // Firebase Configuration (Replace with your actual Firebase config)
        const firebaseConfig = {
            apiKey: "AIzaSyDDdhJ31y8R_NSd08yMprlDg2tbQPd4ii0",
            authDomain: "enactusrsvp-3a4c0.firebaseapp.com",
            projectId: "enactusrsvp-3a4c0",
            storageBucket: "enactusrsvp-3a4c0.firebasestorage.app",
            messagingSenderId: "34193606713",
            appId: "1:34193606713:web:f713754817f79b482065e8",
            measurementId: "G-TVK059C0P4"
        };

        try {
            firebase.initializeApp(firebaseConfig);
            console.log("Firebase initialized successfully");
        } catch (error) {
            console.error("Firebase initialization error:", error);
        }

        const db = firebase.firestore();

        document.addEventListener('DOMContentLoaded', () => {
            const urlParams = new URLSearchParams(window.location.search);
            const alumniId = urlParams.get('id');

            console.log("Alumni ID from URL:", alumniId);

            if (!alumniId) {
                showErrorMessage('Invalid invitation link');
                return;
            }

            const alumniRef = db.collection('alumni').doc(alumniId);

            alumniRef.get()
                .then((doc) => {
                    if (doc.exists) {
                        const alumniData = doc.data();
                        console.log("Alumni Data:", alumniData);

                        // Update Welcome Section
                        document.getElementById('alumniName').textContent = 
                            alumniData.name || 'Alumni';
                        
                        // Use database welcome message, with a fallback
                        document.getElementById('welcomMessage').textContent = 
                            alumniData.WelcomMessage || 
                            `Welcome back! We're excited to celebrate with you.`;
                        
                        document.getElementById('graduationYear').textContent = 
                            `Enactus Class of ${alumniData.graduationYear || 'Unknown'}`;

                        // Pre-fill Name
                        document.getElementById('name').value = alumniData.name || '';
                    } else {
                        showErrorMessage('Alumni record not found');
                    }
                })
                .catch((error) => {
                    console.error("Error fetching alumni:", error);
                    showErrorMessage('Unable to load alumni information');
                });

            // RSVP Form Submission
            const rsvpForm = document.getElementById('rsvpForm');

            rsvpForm.addEventListener('submit', (e) => {
                e.preventDefault();

                const rsvpData = {
                    alumniId: alumniId,
                    name: document.getElementById('name').value,
                    mealPreference: document.getElementById('mealPreference').value,
                    notes: document.getElementById('notes').value,
                    timestamp: firebase.firestore.FieldValue.serverTimestamp()
                };

                // Save RSVP to Firestore
                db.collection('rsvps').add(rsvpData)
                    .then(() => {
                        // Update Alumni RSVP Status
                        return alumniRef.update({ rsvpStatus: 'confirmed' });
                    })
                    .then(() => {
                        // Redirect or show confirmation
                        alert(`Thank You, ${rsvpData.name}! We've reserved your seat for a ${rsvpData.mealPreference} meal.`);
                        window.location.reload(); // or redirect to a thank you page
                    })
                    .catch((error) => {
                        console.error("RSVP Submission Error:", error);
                        alert('Unable to submit RSVP. Please try again.');
                    });
            });

            function showErrorMessage(message) {
                document.getElementById('alumniName').textContent = 'Error';
                document.getElementById('welcomMessage').textContent = message;
                document.getElementById('graduationYear').textContent = '';
            }
        });
    </script>
</body>
</html>
